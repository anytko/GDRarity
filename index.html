<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysis of Ecological and Evolutionary Rarity Status • GeoFunPhy</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Analysis of Ecological and Evolutionary Rarity Status">
<meta name="description" content="EcoStatusR calculates measures of range size, evolutionary distinctiveness, and functional trait distinctiveness to classify the eco-evolutionary rarity status of species. Ecological status can be used to infer associated organismal strategy. GeoFunPhy also allows users to utilize their own data to determine the ecological status of species of interest.">
<meta property="og:description" content="EcoStatusR calculates measures of range size, evolutionary distinctiveness, and functional trait distinctiveness to classify the eco-evolutionary rarity status of species. Ecological status can be used to infer associated organismal strategy. GeoFunPhy also allows users to utilize their own data to determine the ecological status of species of interest.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">GeoFunPhy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/GeoFunPhy.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="geofunphy">GeoFunPhy<a class="anchor" aria-label="anchor" href="#geofunphy"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>GeoFunPhy is a tool used to classify the eco-evolutionary rarity of species varying in geographic, phylogenetic, and functional trait rarity. The ecological status proposed in GeoFunPhy can be used to infer larger organismal strategy.</p>
<ul>
<li>get_phy_angio() sources a choice of phylogeny from Smith &amp; Brown 2018</li>
<li>build_trait_data_LEDA() constructs a dataframe of chosen functional traits from the LEDA trait database</li>
<li>calc_range_size() calculates the range size of species</li>
<li>avg_evol_dist() calculates the evolutionary distinctiveness of species across distinct times and multiple phylogenetic extents</li>
<li>fun_dist() calculates functional distinctiveness (FD) for species based on trait data</li>
<li>scale_by_median() scales desired data within a dataframe using median z scores</li>
<li>elbow_plot() displays an elbowplot for different K means for a variable</li>
<li>compute_wcss() computes the Within-Cluster Sum of Squares (WCSS) for a given variable and a range of cluster values (k) using k-means clustering</li>
<li>define_custom_k_ranges() performs k-means clustering on a variable and define custom ranges based on cluster centers</li>
<li>check_EER_status_k() classifies the eco-evolutionary rarity (EER) of chosen species within a dataframe</li>
<li>get_range_convex_hulls() creates convex hulls for a species using cleaned GBIF occurence data</li>
<li>clip_polygons_to_land() clips range convex hulls to continent boundaries</li>
<li>range_sizes() calculates the range size of clipped convex hulls</li>
<li>get_continent_sf() reads and formats a GeoJSON document with continent data</li>
<li>check_continents() checks which continents species convex hulls occur in</li>
<li>check_biomes() checks which biomes species convex hulls occur in</li>
<li>plot_convex_hulls() plots species’ occurence polygons onto a world map -plot_clipped_hulls() plots species’ clipped occurence polygons (clipped to continent bounds) onto a world map</li>
<li>range_poly_map() creates and plots species’ occurence polygons onto a world map</li>
<li>plot_EER_status() visualizes eco-evolutionary rarity categories in 3D space</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of GeoFunPhy like so:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"anytko/GeoFunPhy"</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a basic example which demonstrates GeoFunPhy useage and shows how you can determine the eco-evolutionary status of common tree genera using SLA, seed_mass, and canopy_height. Note that certain functions, such as those called by calc_range_size() are not included (i.e. get_range_convex_hulls() and clip_polygons_to_land()). Please see the GeoFunPhy vignette for a comprehensive example more information on extra functionality.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(GeoFunPhy)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-trait-dataframe">Create Trait Dataframe<a class="anchor" aria-label="anchor" href="#create-trait-dataframe"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>trait_df <span class="ot">&lt;-</span> <span class="fu">build_trait_data_LEDA</span>(<span class="at">columns_to_select =</span> <span class="fu">c</span>(<span class="st">"SLA"</span>, <span class="st">"seed_mass"</span>, <span class="st">"canopy_height"</span>), <span class="at">genera =</span> <span class="fu">c</span>(<span class="st">"Acer_"</span>, <span class="st">"Pinus_"</span>, <span class="st">"Fraxinus_"</span>, <span class="st">"Quercus_"</span>, <span class="st">"Tsuga_"</span>, <span class="st">"Ulmus"</span>, <span class="st">"Populus"</span>, <span class="st">"Betula_"</span>))</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="input-phylogeny">Input Phylogeny<a class="anchor" aria-label="anchor" href="#input-phylogeny"></a>
</h2>
<p>Users can input their own phylogeny or use one of the four phylogeneies listed in Smith &amp; Brown 2018 including:</p>
<ul>
<li>ALLMB: GenBank and Open Tree of Life taxa with a backbone provided by Magallón et al. 2015</li>
<li>ALLOTB: GenBank and Open Tree of Life taxa with a backbone provided by Open Tree of Life version 9.1</li>
<li>GBMB: GenBank taxa with a backbone provided by Magallón et al. 2015</li>
<li>GBOTB: GenBank taxa with a backbone provided by Open Tree of Life version 9.1”</li>
</ul>
<!-- --><div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>GBMB_phylogeny <span class="ot">&lt;-</span> <span class="fu">get_phy_angio</span>(<span class="st">"GBMB"</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculate-range-sizes">Calculate Range Sizes<a class="anchor" aria-label="anchor" href="#calculate-range-sizes"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>range_sizes_df <span class="ot">&lt;-</span> <span class="fu">calc_range_size</span>(<span class="at">data_frame =</span> trait_df, <span class="at">num_cores =</span> <span class="dv">1</span>, <span class="at">gbif_limit =</span> <span class="dv">2500</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-range-polygons">Plot Range Polygons<a class="anchor" aria-label="anchor" href="#plot-range-polygons"></a>
</h2>
<div class="section level3">
<h3 id="plot-the-range-polygons-of-a-species-from-the-table-above-acer-campestre">Plot the range polygons of a species from the table above: Acer campestre<a class="anchor" aria-label="anchor" href="#plot-the-range-polygons-of-a-species-from-the-table-above-acer-campestre"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>acer_campestre_range <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">species_name =</span> <span class="fu">c</span>(<span class="st">"Acer campestre"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">range_poly_map</span>(<span class="at">data_frame =</span> acer_campestre_range)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="or">OR<a class="anchor" aria-label="anchor" href="#or"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>continent_bounds <span class="ot">&lt;-</span> <span class="fu">get_continent_sf</span>()</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">range_poly_map</span>(<span class="at">data_frame =</span> acer_campestre_range, <span class="at">clip =</span> <span class="cn">TRUE</span>, <span class="at">continent_sf =</span> continent_bounds)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="calculate-average-evolutionary-distinctiveness">Calculate Average Evolutionary Distinctiveness<a class="anchor" aria-label="anchor" href="#calculate-average-evolutionary-distinctiveness"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>trait_range_evol_df <span class="ot">&lt;-</span> <span class="fu">avg_evol_dist</span>(<span class="at">phy =</span> GBMB_phylogeny, <span class="at">data_frame =</span> trait_df, <span class="at">num_cores =</span> <span class="dv">6</span>, <span class="at">time_slices =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">35</span>))</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculate-functional-distinctiveness">Calculate Functional Distinctiveness<a class="anchor" aria-label="anchor" href="#calculate-functional-distinctiveness"></a>
</h2>
<p>In order to calculate functional distinctiveness, we need to remove any species with NA values for any trait.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">merge</span>(trait_df, range_sizes_df, <span class="at">by =</span> <span class="st">"species_name"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>), trait_range_evol_df, <span class="at">by =</span> <span class="st">"species_name"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(merged_df)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>fun_trait_range_evol_df <span class="ot">&lt;-</span> <span class="fu">fun_dist</span>(<span class="at">data_frame =</span> merged_df, <span class="at">trait_columns =</span> <span class="fu">c</span>(<span class="st">"SLA"</span>, <span class="st">"seed_mass"</span>, <span class="st">"canopy_height"</span>))</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="transform-dataframe-around-the-median">Transform Dataframe Around the Median<a class="anchor" aria-label="anchor" href="#transform-dataframe-around-the-median"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>scaled_df <span class="ot">&lt;-</span> <span class="fu">scale_by_median</span>(<span class="at">data_frame =</span> fun_trait_range_evol_df, <span class="at">columns_chosen =</span> <span class="fu">c</span>(<span class="st">"range_size"</span>, <span class="st">"mean_evol_dist"</span>))</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-elbow-plots-to-detmine-optimal-k-means">Create Elbow Plots to Detmine Optimal K Means<a class="anchor" aria-label="anchor" href="#create-elbow-plots-to-detmine-optimal-k-means"></a>
</h2>
<div class="section level3">
<h3 id="the-optimal-k-means-value-can-be-determined-by-finding-the-elbow-or-bend-in-the-plot-for-example-in-the-three-plots-below-a-k--3-represents-the-plots-elbow">The optimal K means value can be determined by finding the “elbow” or bend in the plot. For example, in the three plots below a K = 3 represents the plot’s elbow.<a class="anchor" aria-label="anchor" href="#the-optimal-k-means-value-can-be-determined-by-finding-the-elbow-or-bend-in-the-plot-for-example-in-the-three-plots-below-a-k--3-represents-the-plots-elbow"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>range_elbow <span class="ot">&lt;-</span> <span class="fu">elbow_plot</span>(<span class="at">data =</span> scaled_df, <span class="at">variable =</span> <span class="st">"range_size"</span>, <span class="at">k_max =</span> <span class="dv">10</span>, <span class="at">ggplot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">print</span>(range_elbow)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>evol_elbow <span class="ot">&lt;-</span> <span class="fu">elbow_plot</span>(<span class="at">data =</span> scaled_df, <span class="at">variable =</span> <span class="st">"mean_evol_dist"</span>, <span class="at">k_max =</span> <span class="dv">10</span>, <span class="at">ggplot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="fu">print</span>(evol_elbow)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>fun_elbow <span class="ot">&lt;-</span> <span class="fu">elbow_plot</span>(<span class="at">data =</span> scaled_df, <span class="at">variable =</span> <span class="st">"fun_dist"</span>, <span class="at">k_max =</span> <span class="dv">10</span>, <span class="at">ggplot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="fu">print</span>(fun_elbow)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="determine-eco-evolutionary-rarity-status">Determine Eco-Evolutionary Rarity Status<a class="anchor" aria-label="anchor" href="#determine-eco-evolutionary-rarity-status"></a>
</h2>
<div class="section level3">
<h3 id="hint-use-the-elbow-plots-above-to-determine-optimal-k-means-values">Hint: Use the elbow plots above to determine optimal K means values<a class="anchor" aria-label="anchor" href="#hint-use-the-elbow-plots-above-to-determine-optimal-k-means-values"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>eco_stat_df <span class="ot">&lt;-</span> <span class="fu">check_EER_status_k</span>(<span class="at">data_frame =</span> scaled_df, <span class="at">range_size_col =</span> <span class="st">"range_size"</span>, <span class="at">mean_evol_dist_col =</span> <span class="st">"mean_evol_dist"</span>, <span class="at">fun_dist_col =</span> <span class="st">"fun_dist"</span>, <span class="at">range_size_k =</span> <span class="dv">3</span>, <span class="at">mean_evol_dist_k =</span> <span class="dv">3</span>, <span class="at">fun_dist_k =</span> <span class="dv">3</span>)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-eco-evolutionary-rarity-status">Visualizing Eco-evolutionary Rarity Status<a class="anchor" aria-label="anchor" href="#visualizing-eco-evolutionary-rarity-status"></a>
</h2>
<p>We can map the EER of species from this dataframe onto interactive 3D space. This object can be manipulated and positioned by the user in order to best visualize the respective ecological statuses.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>figure <span class="ot">&lt;-</span> <span class="fu">plot_EER_status</span>(<span class="at">data_frame =</span> eco_stat_df, <span class="at">fun_dist =</span> <span class="st">"fun_dist"</span>, <span class="at">evol_dist =</span> <span class="st">"mean_evol_dist"</span>, <span class="at">range_size =</span> <span class="st">"range_size"</span>)</span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing GeoFunPhy</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Alivia Nytko <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-4499-4839" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alivia Nytko.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
