% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/avg_evol_dist.r
\name{avg_evol_dist}
\alias{avg_evol_dist}
\title{Calculate average evolutionary distinctiveness (ED) for a set of species}
\usage{
avg_evol_dist(
  phy,
  data_frame,
  species_col = "species",
  taxon = NULL,
  time = TRUE,
  time_slices = c(25, 50, 75, 100, 115),
  num_cores = 1
)
}
\arguments{
\item{phy}{A rooted, time-calibrated phylogenetic tree (\code{phylo} object).
Branch lengths must reflect time (e.g., millions of years).}

\item{data_frame}{A data frame containing the species of interest. Must include a column with species names.}

\item{species_col}{A character string specifying the name of the species column in data_frame. Default is "species".}

\item{taxon}{Optional character vector specifying which taxa (species) to compute ED for. If NULL (default), all unique species in data_frame are used.}

\item{time}{Logical; if FALSE, ED is calculated across the full tree. If TRUE, ED is calculated across multiple evolutionary time slices. Default is TRUE}

\item{time_slices}{Numeric vector of time depths (in millions of years ago, MYA) at which to slice the tree. Default is \code{c(25, 50, 75, 100, 115)}. Values must be less than the root age of \code{phy}. Ultrametric trees are recommended.}

\item{num_cores}{Number of CPU cores to use for parallel processing. Default is 1. We recommend increasing this for faster computation.}
}
\value{
A \code{data.frame} with two columns:
\enumerate{
\item The species column (name matches \code{species_col}).
\item \code{ED} â€” the average evolutionary distinctiveness.
}
}
\description{
Computes the average evolutionary distinctiveness (ED) of each species based on a rooted, time-calibrated phylogenetic tree. ED can be calculated either across the full tree or across multiple evolutionary time slices.
}
\details{
Evolutionary distinctiveness (ED) is computed using the \code{"fair.proportion"}method from \strong{picante}. When \code{time = TRUE}, the phylogeny is sliced at each time depth using \code{\link[phytools:treeSlice]{phytools::treeSlice()}} and ED is computed for each slice.
The mean ED across slices is returned for each species.

Calculating ED at several evolutionary depths captures how distinct species are over deep vs. shallow time scales.

Parallel processing is supported via \strong{foreach} and \strong{doParallel}.
}
\examples{
# Generate a phylogeny
set.seed(123)
random_phy <- ape::rtree(n = 7)
random_phy$tip.label <- c("Acer_campestre", "Acer_monspessulanum",
                          "Acer_negundo", "Acer_opalus",
                          "Acer_platanoides", "Acer_pseudoplatanus",
                          "Acer_saccharinum")

# Create a dataframe of species
maple_data <- data.frame(species = random_phy$tip.label)

# Compute ED using time slices
ed_results <- avg_evol_dist(phy = random_phy,
                            data_frame = maple_data,
                            species_col = "species",
                            num_cores = 1,
                            time_slices = c(0.5, 1, 1.5))

print(ed_results)

}
